{% extends 'main/base.html' %}
{% load static %}
{% load i18n %}
{% block content %}
<!-- Main Content -->
<main class="main-content">
    <!-- Tasks Board -->
    <section class="tasks-board">
        <div class="tasks-board__header">
            <h1 class="tasks-board__title">{% trans "–î–æ—à–∫–∞ –∑–∞–≤–¥–∞–Ω—å" %}</h1>
            <div class="filter-bar">
                <select id="filterAssignedTo" class="filter-bar__select"
                        onchange="applyFilter('assigned_to', this.value)">
                    <option value="">{% trans "–í—Å—ñ –∑–∞–≤–¥–∞–Ω–Ω—è" %}</option>
                    <option value="me">{% trans "–ú–æ—ó –∑–∞–≤–¥–∞–Ω–Ω—è" %}</option>
                    <!-- User options will be populated dynamically -->
                </select>
            </div>
            <button class="btn-primary" id="addTaskBtn">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd"
                          d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"
                          clip-rule="evenodd"/>
                </svg>
                {% trans "–î–æ–¥–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è" %}
            </button>
        </div>

        <div class="tasks-columns">
            <!-- To Do Column -->
            <div class="tasks-column">
                <div class="tasks-column__header">
                    <h2 class="tasks-column__title">
                        <span class="tasks-column__icon" style="background-color: #6C757D;">üìã</span>
                        {% trans "–ó—Ä–æ–±–∏—Ç–∏" %}
                        <span class="tasks-column__count" id="todoCount">0</span>
                    </h2>
                </div>
                <div class="tasks-column__content" id="todoColumn">
                    <!-- Task cards will be added here -->
                </div>
            </div>

            <!-- In Progress Column -->
            <div class="tasks-column">
                <div class="tasks-column__header">
                    <h2 class="tasks-column__title">
                        <span class="tasks-column__icon" style="background-color: #FFC107;">‚ö°</span>
                        {% trans "–í –ø—Ä–æ—Ü–µ—Å—ñ" %}
                        <span class="tasks-column__count" id="inProgressCount">0</span>
                    </h2>
                </div>
                <div class="tasks-column__content" id="inProgressColumn">
                    <!-- Task cards will be added here -->
                </div>
            </div>

            <!-- Completed Column -->
            <div class="tasks-column">
                <div class="tasks-column__header">
                    <h2 class="tasks-column__title">
                        <span class="tasks-column__icon" style="background-color: #28A745;">‚úì</span>
                        {% trans "–í–∏–∫–æ–Ω–∞–Ω–æ" %}
                        <span class="tasks-column__count" id="completedCount">0</span>
                    </h2>
                </div>
                <div class="tasks-column__content" id="completedColumn">
                    <!-- Task cards will be added here -->
                </div>
            </div>
        </div>
    </section>
</main>
<!-- Add/Edit Task Modal -->
<div class="modal" id="taskModal">
    <div class="modal__overlay" id="taskModalOverlay"></div>
    <div class="modal__content">
        <div class="modal__header">
            <h2 class="modal__title" id="taskModalTitle">{% trans "–î–æ–¥–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è" %}</h2>
            <button class="modal__close" id="taskModalClose" aria-label="Close modal">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M18 6L6 18M6 6l12 12" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
        <form class="modal__form" id="taskForm">
            <div class="form-group">
                <label class="form-group__label" for="taskTitle">{% trans "–ù–∞–∑–≤–∞ –∑–∞–≤–¥–∞–Ω–Ω—è" %} *</label>
                <input type="text" class="form-group__input" id="taskTitle" name="title" required
                       placeholder="{% trans '–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –∑–∞–≤–¥–∞–Ω–Ω—è' %}">
            </div>

            <div class="form-group">
                <label class="form-group__label" for="taskDescription">{% trans "–û–ø–∏—Å" %}</label>
                <textarea class="form-group__textarea" id="taskDescription" name="description" rows="4"
                          placeholder="{% trans '–û–ø–∏—à—ñ—Ç—å –∑–∞–≤–¥–∞–Ω–Ω—è –¥–µ—Ç–∞–ª—å–Ω—ñ—à–µ...' %}"></textarea>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-group__label" for="taskPriority">{% trans "–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç" %}</label>
                    <select class="form-group__select" id="taskPriority" name="priority">
                        <option value="low">{% trans "–ù–∏–∑—å–∫–∏–π" %}</option>
                        <option value="medium" selected>{% trans "–°–µ—Ä–µ–¥–Ω—ñ–π" %}</option>
                        <option value="high">{% trans "–í–∏—Å–æ–∫–∏–π" %}</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-group__label" for="taskDueDate">{% trans "–¢–µ—Ä–º—ñ–Ω –≤–∏–∫–æ–Ω–∞–Ω–Ω—è" %}</label>
                    <input type="date" class="form-group__input" id="taskDueDate" name="due_date">
                </div>
            </div>

            <div class="form-group">
                <label class="form-group__label" for="taskAssignedTo">{% trans "–ü—Ä–∏–∑–Ω–∞—á–∏—Ç–∏" %}</label>
                <select class="form-group__select" id="taskAssignedTo" name="assigned_to">
                    <option value="">{% trans "–ù–µ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ" %}</option>
                    <!-- Users will be loaded here -->
                </select>
            </div>

            <div class="modal__actions">
                <button type="button" class="modal__btn modal__btn--cancel" id="taskModalCancel">{% trans "–°–∫–∞—Å—É–≤–∞—Ç–∏" %}</button>
                <button type="submit" class="modal__btn modal__btn--save" id="taskModalSaveBtn">{% trans "–°—Ç–≤–æ—Ä–∏—Ç–∏" %}</button>
            </div>
        </form>
    </div>
</div>
<script>
    // Translations for JavaScript
    window.TRANSLATIONS = {
        'no_tasks': '{% trans "–ù–µ–º–∞—î –∑–∞–≤–¥–∞–Ω—å" %}',
        'add_task': '{% trans "–î–æ–¥–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è" %}',
        'create': '{% trans "–°—Ç–≤–æ—Ä–∏—Ç–∏" %}',
        'update': '{% trans "–û–Ω–æ–≤–∏—Ç–∏" %}',
        'edit_task': '{% trans "–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è" %}',
        'not_assigned': '{% trans "–ù–µ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ" %}',
        'take_to_work': '{% trans "–í–∑—è—Ç–∏ –≤ —Ä–æ–±–æ—Ç—É" %}',
        'complete': '{% trans "–ó–∞–≤–µ—Ä—à–∏—Ç–∏" %}',
        'return': '{% trans "–ü–æ–≤–µ—Ä–Ω—É—Ç–∏" %}',
        'locked': '{% trans "–ó–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ" %}',
        'edit': '{% trans "–†–µ–¥–∞–≥—É–≤–∞—Ç–∏" %}',
        'delete': '{% trans "–í–∏–¥–∞–ª–∏—Ç–∏" %}',
        'assigned': '{% trans "–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–æ:" %}',
        'confirm_delete': '{% trans "–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ –∑–∞–≤–¥–∞–Ω–Ω—è?" %}',
        'task_updated': '{% trans "–ó–∞–≤–¥–∞–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω–æ!" %}',
        'task_created': '{% trans "–ó–∞–≤–¥–∞–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–æ!" %}',
        'task_deleted': '{% trans "–ó–∞–≤–¥–∞–Ω–Ω—è –≤–∏–¥–∞–ª–µ–Ω–æ!" %}',
        'status_updated': '{% trans "–°—Ç–∞—Ç—É—Å –∑–∞–≤–¥–∞–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω–æ!" %}',
        'error_loading_users': '{% trans "–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤" %}',
        'error_loading_tasks': '{% trans "–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å" %}',
        'error_updating_status': '{% trans "–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É" %}',
        'error_deleting_task': '{% trans "–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è" %}',
        'error_saving_task': '{% trans "–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è" %}',
        'priority_low': '{% trans "–ù–∏–∑—å–∫–∏–π" %}',
        'priority_medium': '{% trans "–°–µ—Ä–µ–¥–Ω—ñ–π" %}',
        'priority_high': '{% trans "–í–∏—Å–æ–∫–∏–π" %}'
    };
</script>
<script src="{% static 'js/tasks.js' %}"></script>
{% endblock %}
